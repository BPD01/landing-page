<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Métodos de Pascal e Markowitz</title>
    <!-- Incluindo bibliotecas necessárias -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/3.0.2/topojson.min.js"></script>
    <style>
        :root {
            --primary-blue: #205baa;
            --secondary-blue: #23609f;
            --accent-yellow: #eac730;
            --light-gray: #eef1f1;
            --medium-gray: #a6a9ae;
            --white: #ffffff;
            --dark-text: #333333;
            --probability-blue: #205baa;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light-gray);
            color: var(--primary-blue);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            font-size: 18px;
            line-height: 1.6;
        }
        
        header {
            background-color: var(--primary-blue);
            color: white;
            padding: 1.2rem 2rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }
        
        .header-logo {
            height: 80px;
            width: auto;
        }
        
        .logo {
            font-size: 2rem;
            font-weight: 600;
            text-align: center;
            flex: 1;
        }
        
        .access-link {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.3s;
            font-weight: 500;
            font-size: 1.1rem;
            background-color: rgba(255, 255, 255, 0.2);
            white-space: nowrap;
            margin-right: auto;
        }
        
        .access-link:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        /* Bandeiras de idioma */
        .language-flags {
            display: flex;
            gap: 10px;
            margin-left: 20px;
            align-items: center;
        }
        
        .flag {
            width: 35px;
            height: 25px;
            cursor: pointer;
            border: 2px solid transparent;
            border-radius: 3px;
            transition: all 0.3s ease;
        }
        
        .flag:hover {
            transform: scale(1.1);
            border-color: var(--accent-yellow);
        }
        
        .flag.active {
            border-color: var(--accent-yellow);
            box-shadow: 0 0 5px rgba(234, 199, 48, 0.7);
        }
        
        /* Ajuste no nav para acomodar as bandeiras */
        nav {
            display: flex;
            align-items: center;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        
        nav li {
            margin-left: 1.5rem;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.3s;
            font-weight: 500;
            font-size: 1.1rem;
        }
        
        nav a:hover {
            background-color: var(--secondary-blue);
        }
        
        main {
            flex: 1;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }
        
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        .home-container {
            text-align: center;
            padding: 2rem 0;
        }
        
        .home-title {
            color: var(--primary-blue);
            margin-bottom: 1.5rem;
            font-size: 2.8rem;
            font-weight: 600;
        }
        
        .home-subtitle {
            color: var(--secondary-blue);
            margin-bottom: 3rem;
            font-size: 1.6rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            font-weight: 700;
            line-height: 1.8;
        }
        
        .button-container {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 4rem;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 1.2rem 2.5rem;
            font-size: 1.3rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            min-width: 220px;
        }
        
        .btn-primary {
            background-color: var(--primary-blue);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--secondary-blue);
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }
        
        .btn-secondary {
            background-color: var(--primary-blue);
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: var(--secondary-blue);
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }
        
        .btn-download {
            background-color: #23609f;
            color: white;
        }
        
        .btn-download:hover {
            background-color: #23609f;
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }
        
        footer {
            background-color: var(--primary-blue);
            color: white;
            padding: 1.5rem 2rem;
            margin-top: auto;
        }
        
        .citation {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .logos {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }
        
        .logo-img {
            height: 75px;
        }
        
        .footer-text {
            text-align: center;
            margin: 0 20px;
            flex-grow: 1;
        }
        
        .footer-text p {
            font-size: 14px;
            margin: 8px 0;
            color: white;
            line-height: 1.5;
        }
        
        /* Página de configuração */
        .config-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .config-title {
            color: var(--primary-blue);
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 2.2rem;
        }
        
        .input-group {
            margin-bottom: 1.5rem;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--secondary-blue);
            font-size: 1.2rem;
        }
        
        .input-group input {
            width: 100%;
            padding: 1rem;
            border: 1px solid var(--medium-gray);
            border-radius: 4px;
            font-size: 1.2rem;
            color: var(--primary-blue);
        }
        
        .error {
            color: #d32f2f;
            font-size: 1rem;
            margin-top: 0.5rem;
            display: none;
        }
        
        /* Página da matriz */
        .matrix-container {
            overflow-x: auto;
        }
        
        .matrix-title {
            color: var(--primary-blue);
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 2.2rem;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 2rem;
            background-color: white;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        th, td {
            border: 1px solid var(--medium-gray);
            padding: 1rem;
            text-align: center;
            font-size: 1.2rem;
        }
        
        th {
            background-color: var(--primary-blue);
            color: white;
            font-weight: 600;
            font-size: 1.3rem;
        }
        
        .prob-row {
            background-color: #eef0f1;
            font-weight: 600;
            color: var(--probability-blue);
        }
        
        .state-name {
            font-weight: 600;
            background-color: rgba(32, 91, 170, 0.1);
            color: var(--primary-blue);
        }
        
        .alternative-name {
            color: var(--primary-blue);
        }
        
        .value-input {
            color: var(--primary-blue);
        }
        
        .sum-display {
            margin-bottom: 1rem;
            font-weight: 600;
            font-size: 1.3rem;
            color: var(--primary-blue);
        }
        
        .sum-error {
            color: #d32f2f;
        }
        
        .sum-ok {
            color: #388e3c;
        }
        
        .results-container {
            margin-top: 2rem;
            display: none;
        }
        
        .results-title {
            color: var(--primary-blue);
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 2.2rem;
        }
        
        .method-section {
            margin-bottom: 2rem;
            background-color: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .method-title {
            color: var(--secondary-blue);
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--accent-yellow);
            padding-bottom: 0.5rem;
            font-size: 1.6rem;
        }
        
        .ranking {
            margin-top: 1rem;
        }
        
        .ranking-item {
            display: flex;
            justify-content: space-between;
            padding: 1rem;
            border-bottom: 1px solid var(--medium-gray);
            font-size: 1.3rem;
        }
        
        .ranking-item:last-child {
            border-bottom: none;
        }
        
        .ranking-position {
            font-weight: 600;
            color: var(--primary-blue);
            font-size: 1.4rem;
        }
        
        .ranking-winner {
            background-color: rgba(46, 125, 50, 0.1);
            font-weight: 600;
            border-radius: 4px;
        }
        
        .download-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
            margin-bottom: 2rem;
        }
        
        /* Página Sobre Nós */
        .about-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .about-title {
            color: var(--primary-blue);
            margin-bottom: 2rem;
            text-align: center;
            font-size: 2.2rem;
        }
        
        .authors-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2rem;
            justify-items: center;
        }
        
        .author-card {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            text-align: center;
            padding: 1.5rem;
            width: 100%;
            max-width: 280px;
        }
        
        .author-card:hover {
            transform: translateY(-5px);
        }
        
        .author-photo {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary-blue);
            margin: 0 auto 1rem;
        }
        
        .author-info {
            padding: 0;
        }
        
        .author-name {
            color: var(--primary-blue);
            margin-bottom: 1rem;
            font-size: 1.4rem;
        }
        
        .social-links {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .social-link {
            display: inline-block;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            transition: all 0.3s;
            overflow: hidden;
        }
        
        .social-link:hover {
            transform: scale(1.1);
        }
        
        .social-icon {
            width: 24px;
            height: 24px;
            object-fit: contain;
        }
        
        .social-link-disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .social-link-disabled:hover {
            transform: none;
        }
        
        /* Página do Tutorial */
        .tutorial-container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .tutorial-title {
            color: var(--primary-blue);
            margin-bottom: 2rem;
            text-align: center;
            font-size: 2.2rem;
        }
        
        .tutorial-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .youtube-link {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-blue);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s;
        }
        
        .youtube-link:hover {
            color: var(--secondary-blue);
        }
        
        .youtube-icon {
            width: 24px;
            height: 24px;
        }
        
        .carousel-container {
            position: relative;
            width: 100%;
            margin: 0 auto;
            overflow: hidden;
        }
        
        .carousel-slides {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }
        
        .carousel-slide {
            min-width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .carousel-image {
            max-width: 100%;
            max-height: 600px;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }
        
        .carousel-button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(32, 91, 170, 0.7);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s;
            z-index: 10;
            opacity: 0;
        }
        
        .carousel-container:hover .carousel-button {
            opacity: 1;
        }
        
        .carousel-button:hover {
            background-color: var(--primary-blue);
        }
        
        .carousel-prev {
            left: 10px;
        }
        
        .carousel-next {
            right: 10px;
        }
        
        .carousel-indicators {
            display: flex;
            justify-content: center;
            margin-top: 1rem;
            gap: 0.5rem;
        }
        
        .carousel-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--medium-gray);
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .carousel-indicator.active {
            background-color: var(--primary-blue);
        }
        
        /* Página de Artigos Científicos */
        .articles-container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .articles-title {
            color: var(--primary-blue);
            margin-bottom: 2rem;
            text-align: center;
            font-size: 2.2rem;
        }
        
        .articles-list {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .article-item {
            padding: 1.5rem;
            border: 1px solid var(--medium-gray);
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .article-item:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-3px);
        }
        
        .article-title {
            color: var(--primary-blue);
            margin-bottom: 0.5rem;
            font-size: 1.4rem;
            font-weight: 600;
        }
        
        .article-link {
            color: var(--secondary-blue);
            text-decoration: none;
            font-weight: 500;
            display: inline-block;
            margin-top: 0.5rem;
            transition: color 0.3s;
        }
        
        .article-link:hover {
            color: var(--primary-blue);
            text-decoration: underline;
        }
        
        /* Estilo para as imagens dos autores na página inicial */
        .authors-images {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-bottom: 4rem;
        }
        
        .author-image {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid var(--primary-blue);
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .author-image:hover {
            transform: scale(1.05);
        }
        
        .author-tooltip {
            position: relative;
            display: inline-block;
        }
        
        .author-tooltip .tooltip-text {
            visibility: hidden;
            width: 120px;
            background-color: var(--primary-blue);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: -40px;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-weight: 600;
        }
        
        .author-tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        
        /* Página de Acessos */
        .access-container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .access-title {
            color: var(--primary-blue);
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 2.2rem;
        }
        
        .access-login-container {
            max-width: 400px;
            margin: 0 auto;
        }
        
        .access-stats {
            margin-top: 2rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background-color: var(--light-gray);
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            font-size: 1.2rem;
            color: var(--secondary-blue);
        }
        
        .map-container {
            margin-top: 2rem;
            width: 100%;
            height: 500px;
            background-color: #f8f9fa;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }
        
        .country-list {
            margin-top: 2rem;
        }
        
        .country-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid var(--medium-gray);
        }
        
        .country-item:last-child {
            border-bottom: none;
        }
        
        .country-name {
            font-size: 1.3rem;
            color: var(--primary-blue);
        }
        
        .country-count {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--secondary-blue);
        }
        
        .map-legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            z-index: 10;
        }
        
        .legend-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--primary-blue);
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 3px;
        }
        
        .legend-color {
            width: 20px;
            height: 15px;
            margin-right: 5px;
            border: 1px solid #ccc;
        }
        
        .legend-label {
            font-size: 12px;
        }
        
        @media (max-width: 1200px) {
            .authors-container {
                grid-template-columns: repeat(2, 1fr);
                gap: 2rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .logo-container {
                justify-content: center;
                margin-bottom: 1rem;
                gap: 1rem;
                flex-direction: column;
            }
            
            .header-logo {
                height: 50px;
            }
            
            /* Ajuste para as bandeiras no mobile */
            nav {
                flex-direction: column;
                gap: 10px;
            }
            
            .language-flags {
                margin-left: 0;
                margin-top: 10px;
            }
            
            nav ul {
                margin-top: 1rem;
                justify-content: center;
            }
            
            nav li {
                margin: 0 0.5rem;
            }
            
            .button-container {
                flex-direction: column;
                align-items: center;
            }
            
            .logos {
                flex-direction: column;
                gap: 1rem;
            }
            
            .authors-container {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            
            .author-card {
                max-width: 300px;
            }
            
            .download-buttons {
                flex-direction: column;
            }
            
            .tutorial-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .carousel-button {
                width: 35px;
                height: 35px;
                font-size: 1rem;
                opacity: 1;
            }
            
            .authors-images {
                flex-direction: column;
                align-items: center;
                gap: 2rem;
            }
            
            .map-container {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo-container">
                <a href="#" class="access-link nav-link" data-page="access">Acessos</a>
                <img src="https://i.ibb.co/pvyJXcc9/brasao-removebg-preview.png" class="header-logo" alt="UFF">
                <div class="logo">Métodos de Pascal e Markowitz</div>
            </div>
            <nav>
                <ul>
                    <li><a href="#" class="nav-link" data-page="home">Início</a></li>
                    <li><a href="#" class="nav-link" data-page="about">Sobre Nós</a></li>
                </ul>
                <div class="language-flags">
                    <img src="https://i.ibb.co/F0ktMmH/Brasil.png" class="flag active" id="flag-br" alt="Português" title="Português">
                    <img src="https://i.ibb.co/s1bs2K0/United-Kingdom.png" class="flag" id="flag-gb" alt="English" title="English">
                </div>
            </nav>
        </div>
    </header>
    
    <main>
        <!-- Página Inicial -->
        <section id="home" class="page active">
            <div class="home-container" style="padding: 3rem 0;">
                <div class="authors-images">
                    <div class="author-tooltip">
                        <img src="https://i.ibb.co/24j0nBb/Whats-App-Image-2025-11-04-at-10-28-32.jpg" alt="Blaise Pascal" class="author-image">
                        <span class="tooltip-text">Blaise Pascal</span>
                    </div>
                    <div class="author-tooltip">
                        <img src="https://i.ibb.co/5WnhhjZM/Whats-App-Image-2025-11-04-at-10-28-11.jpg" alt="Harry Markowitz" class="author-image">
                        <span class="tooltip-text">Harry Markowitz</span>
                    </div>
                </div>
                
                <div class="button-container">
                    <button id="start-app" class="btn btn-primary">Iniciar Aplicação</button>
                    <button class="btn btn-secondary nav-link" data-page="tutorial">Tutorial</button>
                    <button class="btn btn-secondary nav-link" data-page="articles">Artigos Científicos</button>
                </div>
            </div>
        </section>
        
        <!-- Página de Configuração -->
        <section id="config" class="page">
            <div class="config-container">
                <h2 class="config-title">Matriz de Decisão</h2>
                
                <div class="input-group">
                    <label for="alternatives">Número de Alternativas:</label>
                    <input type="number" id="alternatives" min="2" value="2">
                    <div class="error" id="alternatives-error">O número de alternativas deve ser pelo menos 2.</div>
                </div>
                
                <div class="input-group">
                    <label for="states">Número de Estados da Natureza:</label>
                    <input type="number" id="states" min="2" value="2">
                    <div class="error" id="states-error">O número de estados da natureza deve ser pelo menos 2.</div>
                </div>
                
                <button id="generate-matrix" class="btn btn-primary" style="width: 100%; font-size: 1.3rem;">Gerar Matriz de Decisão</button>
            </div>
        </section>
        
        <!-- Página da Matriz -->
        <section id="matrix" class="page">
            <div class="matrix-container">
                <h2 class="matrix-title">Matriz de Decisão</h2>
                
                <div class="sum-display" id="sum-display"></div>
                
                <div id="matrix-table"></div>
                
                <button id="calculate-results" class="btn btn-primary" style="width: 100%; font-size: 1.3rem;">Calcular Resultados</button>
                
                <div class="results-container" id="results-container">
                    <h2 class="results-title">Resultados dos Métodos</h2>
                    
                    <div class="download-buttons">
                        <button id="download-pdf" class="btn btn-download">Baixar PDF</button>
                        <button id="download-images" class="btn btn-download">Baixar Imagens</button>
                    </div>
                    
                    <div class="method-section">
                        <h3 class="method-title">Método de Pascal</h3>
                        <div id="pascal-results"></div>
                    </div>
                    
                    <div class="method-section">
                        <h3 class="method-title">Método de Markowitz</h3>
                        <div id="markowitz-results"></div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Página Sobre Nós -->
        <section id="about" class="page">
            <div class="about-container">
                <h2 class="about-title">Sobre Nós</h2>
                
                <div class="authors-container">
                    <!-- Bruno Pereira Diniz -->
                    <div class="author-card">
                        <img src="https://i.ibb.co/RpMqQmGc/20220425-1847544.jpg" alt="Bruno Pereira Diniz" class="author-photo">
                        <div class="author-info">
                            <h3 class="author-name">Bruno Pereira Diniz</h3>
                            <div class="social-links">
                                <a href="http://lattes.cnpq.br/9664677647691745" class="social-link" title="Lattes" target="_blank">
                                    <img src="https://i.ibb.co/LDrxN30t/image.png" alt="Lattes" class="social-icon">
                                </a>
                                <a href="https://www.linkedin.com/in/bruno-pereira-diniz-13a303214/" class="social-link" title="LinkedIn" target="_blank">
                                    <img src="https://i.ibb.co/kZL8nTL/image.png" alt="LinkedIn" class="social-icon">
                                </a>
                                <a href="https://orcid.org/0009-0008-6621-7823" class="social-link" title="ORCID" target="_blank">
                                    <img src="https://i.ibb.co/BVr0JMtF/image.png" alt="ORCID" class="social-icon">
                                </a>
                                <a href="https://www.researchgate.net/profile/Bruno-Pereira-Diniz" class="social-link" title="ResearchGate" target="_blank">
                                    <img src="https://i.ibb.co/HpHjNJHR/image.png" alt="ResearchGate" class="social-icon">
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Marcos dos Santos -->
                    <div class="author-card">
                        <img src="https://i.ibb.co/7N4Y3JbQ/image.png" alt="Marcos dos Santos" class="author-photo">
                        <div class="author-info">
                            <h3 class="author-name">Marcos dos Santos</h3>
                            <div class="social-links">
                                <a href="http://lattes.cnpq.br/5534398558592175" class="social-link" title="Lattes" target="_blank">
                                    <img src="https://i.ibb.co/LDrxN30t/image.png" alt="Lattes" class="social-icon">
                                </a>
                                <a href="https://www.linkedin.com/in/profmarcosdossantos/" class="social-link" title="LinkedIn" target="_blank">
                                    <img src="https://i.ibb.co/kZL8nTL/image.png" alt="LinkedIn" class="social-icon">
                                </a>
                                <a href="https://orcid.org/0000-0003-1533-5535" class="social-link" title="ORCID" target="_blank">
                                    <img src="https://i.ibb.co/BVr0JMtF/image.png" alt="ORCID" class="social-icon">
                                </a>
                                <a href="https://www.researchgate.net/profile/Marcos_Dos_Santos6" class="social-link" title="ResearchGate" target="_blank">
                                    <img src="https://i.ibb.co/HpHjNJHR/image.png" alt="ResearchGate" class="social-icon">
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Thiago Fernandes Lima -->
                    <div class="author-card">
                        <img src="https://i.ibb.co/DS2BcXD/image.png" alt="Thiago Fernandes Lima" class="author-photo">
                        <div class="author-info">
                            <h3 class="author-name">Thiago Lima</h3>
                            <div class="social-links">
                                <a href="http://lattes.cnpq.br/0204895344524909" class="social-link" title="Lattes" target="_blank">
                                    <img src="https://i.ibb.co/LDrxN30t/image.png" alt="Lattes" class="social-icon">
                                </a>
                                <a href="https://www.linkedin.com/in/thiago-lima-8b69012a/" class="social-link" title="LinkedIn" target="_blank">
                                    <img src="https://i.ibb.co/kZL8nTL/image.png" alt="LinkedIn" class="social-icon">
                                </a>
                                <a href="#" class="social-link social-link-disabled" title="ORCID" onclick="return false;">
                                    <img src="https://i.ibb.co/BVr0JMtF/image.png" alt="ORCID" class="social-icon">
                                </a>
                                <a href="https://www.researchgate.net/profile/Thiago-Lima-28" class="social-link" title="ResearchGate" target="_blank">
                                    <img src="https://i.ibb.co/HpHjNJHR/image.png" alt="ResearchGate" class="social-icon">
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Daniel Augusto de Moura Pereira -->
                    <div class="author-card">
                        <img src="https://i.ibb.co/tp7zmLFB/image.png" alt="Daniel Augusto de Moura Pereira" class="author-photo">
                        <div class="author-info">
                            <h3 class="author-name">Daniel Moura</h3>
                            <div class="social-links">
                                <a href="http://lattes.cnpq.br/5889152523620761" class="social-link" title="Lattes" target="_blank">
                                    <img src="https://i.ibb.co/LDrxN30t/image.png" alt="Lattes" class="social-icon">
                                </a>
                                <a href="https://www.linkedin.com/in/prof-dr-daniel-moura-37198913b/" class="social-link" title="LinkedIn" target="_blank">
                                    <img src="https://i.ibb.co/kZL8nTL/image.png" alt="LinkedIn" class="social-icon">
                                </a>
                                <a href="https://orcid.org/0000-0002-7951-6098" class="social-link" title="ORCID" target="_blank">
                                    <img src="https://i.ibb.co/BVr0JMtF/image.png" alt="ORCID" class="social-icon">
                                </a>
                                <a href="https://www.researchgate.net/profile/Daniel-Augusto-Moura-Pereira" class="social-link" title="ResearchGate" target="_blank">
                                    <img src="https://i.ibb.co/HpHjNJHR/image.png" alt="ResearchGate" class="social-icon">
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Página do Tutorial -->
        <section id="tutorial" class="page">
            <div class="tutorial-container">
                <div class="tutorial-header">
                    <h2 class="tutorial-title">Tutorial</h2>
                    <a href="#" class="youtube-link" id="youtube-link">
                        <img src="https://i.ibb.co/qMmN5VzX/image.png" alt="YouTube" class="youtube-icon">
                        <span>Aula Completa</span>
                    </a>
                </div>
                
                <div class="carousel-container">
                    <div class="carousel-slides">
                        <div class="carousel-slide">
                            <img src="https://i.ibb.co/Tq2dFJbg/Slide1.png" alt="Método de Pascal e Markowitz - Passo 1" class="carousel-image">
                        </div>
                        <div class="carousel-slide">
                            <img src="https://i.ibb.co/jGKBkHF/Slide2.png" alt="Método de Pascal e Markowitz - Passo 2" class="carousel-image">
                        </div>
                        <div class="carousel-slide">
                            <img src="https://i.ibb.co/MxSY0dYC/Slide3.png" alt="Método de Pascal e Markowitz - Passo 3" class="carousel-image">
                        </div>
                        <div class="carousel-slide">
                            <img src="https://i.ibb.co/cS9666CY/Slide4.png" alt="Método de Pascal e Markowitz - Passo 4" class="carousel-image">
                        </div>
                        <div class="carousel-slide">
                            <img src="https://i.ibb.co/JWqFd9Q3/Slide5.png" alt="Método de Pascal e Markowitz - Passo 5" class="carousel-image">
                        </div>
                        <div class="carousel-slide">
                            <img src="https://i.ibb.co/zW2hGwYd/Slide6.png" alt="Método de Pascal e Markowitz - Passo 6" class="carousel-image">
                        </div>
                    </div>
                    
                    <button class="carousel-button carousel-prev">&#10094;</button>
                    <button class="carousel-button carousel-next">&#10095;</button>
                    
                    <div class="carousel-indicators">
                        <span class="carousel-indicator active" data-index="0"></span>
                        <span class="carousel-indicator" data-index="1"></span>
                        <span class="carousel-indicator" data-index="2"></span>
                        <span class="carousel-indicator" data-index="3"></span>
                        <span class="carousel-indicator" data-index="4"></span>
                        <span class="carousel-indicator" data-index="5"></span>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Página de Artigos Científicos -->
        <section id="articles" class="page">
            <div class="articles-container">
                <h2 class="articles-title">Artigos Científicos Relacionados</h2>
                
                <div class="articles-list">
                    <div class="article-item">
                        <h3 class="article-title">Tendências do Critério de Markowitz: Uma Análise Bibliométrica por Meio do Software Bibliomagika®</h3>
                        <p>Autores: Luana de Azevedo de Oliveira (UFF), Marcos dos Santos (EN), Carlos Francisco Simões Gomes (UFF), Enderson Luiz Pereira Junior (UFF) e Emerson Hissao Kojima (UFPR).</p>
                        <a href="http://www.abepro.org.br/biblioteca/TN_ST_413_2030_47719.pdf" class="article-link" target="_blank">Acessar Artigo Completo (PDF)</a>
                    </div>
                    
                    <div class="article-item">
                        <h3 class="article-title">Desenvolvimento de uma ferramenta computacional em linguagem R do método Critério de Markowitz</h3>
                        <p>Autores: Luana de Azevedo de Oliveira (UFF), Marcos dos Santos (EN), Carlos Francisco Simões Gomes (UFF), Enderson Luiz Pereira Junior (UFF) e Emerson Hissao Kojima (UFPR).</p>
                        <a href="https://proceedings.science/proceedings/100475/_papers/193384/download/fulltext_file1?lang=pt-br" class="article-link" target="_blank">Acessar Artigo Completo (PDF)</a>
                    </div>

                    <div class="article-item">
                        <h3 class="article-title">Análise de Dados Bibliométricos com o Software Bibliomagika®: Do Tratamento à Extração de Insights</h3>
                        <p>Autores: Luana de Azevedo de Oliveira (UFF), Marcos dos Santos (EN), Carlos Francisco Simões Gomes (UFF), Enderson Luiz Pereira Junior (UFF) e Emerson Hissao Kojima (UFPR).</p>
                        <a href="https://cneg.org/anais/download.php?acao=anais&evento=CNEG2024&codigo=CNEG_PT_050_0403_23397.pdf" class="article-link" target="_blank">Acessar Artigo Completo (PDF)</a>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Página de Acessos -->
        <section id="access" class="page">
            <div class="access-container">
                <h2 class="access-title">Acessos por País</h2>
                
                <div id="access-login-container" class="access-login-container">
                    <div class="input-group">
                        <label for="access-password">Senha de Acesso:</label>
                        <input type="password" id="access-password" placeholder="Digite a senha">
                        <div class="error" id="access-error">Senha incorreta. Tente novamente.</div>
                    </div>
                    <button id="access-login" class="btn btn-primary" style="width: 100%; font-size: 1.3rem;">Acessar</button>
                </div>
                
                <div id="access-content" class="access-content" style="display: none;">
                    <div class="access-stats">
                        <h3 style="color: var(--primary-blue); margin-bottom: 1.5rem; text-align: center; font-size: 1.8rem;">Estatísticas de Acesso</h3>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="total-accesses">0</div>
                                <div class="stat-label">Total de Acessos</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="total-countries">0</div>
                                <div class="stat-label">Países Diferentes</div>
                            </div>
                        </div>
                        
                        <div class="map-container">
                            <div id="world-map"></div>
                            <div class="map-legend">
                                <div class="legend-title" data-translate="access-intensity">Intensidade de Acessos</div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #e6f2ff;"></div>
                                    <div class="legend-label" data-translate="legend-0">0 acessos</div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #b3d9ff;"></div>
                                    <div class="legend-label" data-translate="legend-1-5">1-5 acessos</div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #80bfff;"></div>
                                    <div class="legend-label" data-translate="legend-6-15">6-15 acessos</div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #4da6ff;"></div>
                                    <div class="legend-label" data-translate="legend-16-30">16-30 acessos</div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #1a8cff;"></div>
                                    <div class="legend-label" data-translate="legend-31-50">31-50 acessos</div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #0066cc;"></div>
                                    <div class="legend-label" data-translate="legend-51-plus">51+ acessos</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="country-list">
                            <h4 style="color: var(--primary-blue); margin-bottom: 1rem; font-size: 1.5rem;">Acessos por País</h4>
                            <div id="country-list-content"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="citation">
            <div class="logos" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                <img src="https://i.ibb.co/xtXbG76y/Escola-Naval-removebg-preview.png" class="logo-img" alt="UFCG" style="height: 75px;">
                <div class="footer-text" style="text-align: center; margin: 0 20px; flex-grow: 1;">
                    <p style="font-size: 14px; margin: 8px 0; color: white; line-height: 1.5;">Todos os direitos reservados. O uso não comercial (acadêmico) deste software é gratuito.</p>
                    <p style="font-size: 14px; margin: 8px 0; color: white; line-height: 1.5;">A única coisa que se pede em troca é citar este software quando os resultados são usados em publicações.</p>
                    <p style="font-size: 14px; margin: 8px 0; color: white; line-height: 1.5;">Para citar o software: DINIZ, Bruno Pereira; SANTOS, Marcos dos; LIMA, Thiago Fernandes; PEREIRA, Daniel Augusto de Moura. Métodos de Pascal e Markowitz web (v.1). 2025.</p>
                </div>
                <img src="https://i.ibb.co/M5xdL1ZS/UFCG.png" class="logo-img" alt="UFF" style="height: 75px;">
            </div>
        </div>
    </footer>

    <script>
        // Sistema de tradução
        const translations = {
            'pt-BR': {
                'title': 'Métodos de Pascal e Markowitz',
                'nav-home': 'Início',
                'nav-about': 'Sobre Nós',
                'nav-access': 'Acessos',
                'home-title': 'Métodos de Pascal e Markowitz',
                'home-subtitle': 'Uma ferramenta para auxiliar na tomada de decisão sob incerteza utilizando os métodos de Pascal e Markowitz',
                'start-app': 'Iniciar Aplicação',
                'tutorial': 'Tutorial',
                'articles': 'Artigos Científicos',
                'config-title': 'Matriz de Decisão',
                'alternatives-label': 'Número de Alternativas:',
                'states-label': 'Número de Estados da Natureza:',
                'alternatives-error': 'O número de alternativas deve ser pelo menos 2.',
                'states-error': 'O número de estados da natureza deve ser pelo menos 2.',
                'generate-matrix': 'Gerar Matriz de Decisão',
                'matrix-title': 'Matriz de Decisão',
                'sum-display': 'Soma das Probabilidades:',
                'calculate-results': 'Calcular Resultados',
                'results-title': 'Resultados dos Métodos',
                'download-pdf': 'Baixar PDF',
                'download-images': 'Baixar Imagens',
                'pascal-method': 'Método de Pascal',
                'markowitz-method': 'Método de Markowitz',
                'about-title': 'Sobre Nós',
                'tutorial-title': 'Tutorial',
                'youtube-link': 'Aula Completa',
                'articles-title': 'Artigos Científicos Relacionados',
                'footer-text1': 'Todos os direitos reservados. O uso não comercial (acadêmico) deste software é gratuito.',
                'footer-text2': 'A única coisa que se pede em troca é citar este software quando os resultados são usados em publicações.',
                'footer-text3': 'Para citar o software: DINIZ, Bruno Pereira; SANTOS, Marcos dos; LIMA, Thiago Fernandes; PEREIRA, Daniel Augusto de Moura. Métodos de Pascal e Markowitz web (v.1). 2025.',
                'alternatives-states': 'Alternativas/Estados',
                'probabilities': 'Probabilidades',
                'state': 'Estado',
                'alternative': 'Alternativa',
                'access-title': 'Acessos por País',
                'access-password': 'Senha de Acesso:',
                'access-error': 'Senha incorreta. Tente novamente.',
                'access-login': 'Acessar',
                'total-accesses': 'Total de Acessos',
                'total-countries': 'Países Diferentes',
                'accesses-by-country': 'Acessos por País',
                'access-intensity': 'Intensidade de Acessos',
                'legend-0': '0 acessos',
                'legend-1-5': '1-5 acessos',
                'legend-6-15': '6-15 acessos',
                'legend-16-30': '16-30 acessos',
                'legend-31-50': '31-50 acessos',
                'legend-51-plus': '51+ acessos'
            },
            'en': {
                'title': 'Pascal and Markowitz Methods',
                'nav-home': 'Home',
                'nav-about': 'About Us',
                'nav-access': 'Accesses',
                'home-title': 'Pascal and Markowitz Methods',
                'home-subtitle': 'A tool to assist in decision making under uncertainty using Pascal and Markowitz methods',
                'start-app': 'Start Application',
                'tutorial': 'Tutorial',
                'articles': 'Scientific Articles',
                'config-title': 'Decision Matrix',
                'alternatives-label': 'Number of Alternatives:',
                'states-label': 'Number of States of Nature:',
                'alternatives-error': 'The number of alternatives must be at least 2.',
                'states-error': 'The number of states of nature must be at least 2.',
                'generate-matrix': 'Generate Decision Matrix',
                'matrix-title': 'Decision Matrix',
                'sum-display': 'Sum of Probabilities:',
                'calculate-results': 'Calculate Results',
                'results-title': 'Method Results',
                'download-pdf': 'Download PDF',
                'download-images': 'Download Images',
                'pascal-method': 'Pascal Method',
                'markowitz-method': 'Markowitz Method',
                'about-title': 'About Us',
                'tutorial-title': 'Tutorial',
                'youtube-link': 'Complete Class',
                'articles-title': 'Related Scientific Articles',
                'footer-text1': 'All rights reserved. Non-commercial (academic) use of this software is free.',
                'footer-text2': 'The only thing asked in return is to cite this software when results are used in publications.',
                'footer-text3': 'To cite the software: DINIZ, Bruno Pereira; SANTOS, Marcos dos; LIMA, Thiago Fernandes; PEREIRA, Daniel Augusto de Moura. Pascal and Markowitz methods web (v.1). 2025.',
                'alternatives-states': 'Alternatives/States',
                'probabilities': 'Probabilities',
                'state': 'State',
                'alternative': 'Alternative',
                'access-title': 'Access by Country',
                'access-password': 'Access Password:',
                'access-error': 'Incorrect password. Try again.',
                'access-login': 'Access',
                'total-accesses': 'Total Accesses',
                'total-countries': 'Different Countries',
                'accesses-by-country': 'Accesses by Country',
                'access-intensity': 'Access Intensity',
                'legend-0': '0 accesses',
                'legend-1-5': '1-5 accesses',
                'legend-6-15': '6-15 accesses',
                'legend-16-30': '16-30 accesses',
                'legend-31-50': '31-50 accesses',
                'legend-51-plus': '51+ accesses'
            }
        };

        let currentLanguage = 'pt-BR';
        let accessData = {
            totalAccesses: 0,
            countries: {}
        };

        // =============================================
        // FUNÇÕES DE DETECÇÃO DE PAÍS PARA WEB
        // =============================================

        // Mapeamento de códigos de país para nomes completos (em inglês para compatibilidade com o mapa)
        const countryCodeToName = {
            'BR': 'Brazil', 'US': 'United States', 'PT': 'Portugal', 'ES': 'Spain',
            'FR': 'France', 'DE': 'Germany', 'IT': 'Italy', 'GB': 'United Kingdom',
            'CA': 'Canada', 'AU': 'Australia', 'JP': 'Japan', 'CN': 'China',
            'IN': 'India', 'RU': 'Russia', 'MX': 'Mexico', 'AR': 'Argentina',
            'CL': 'Chile', 'CO': 'Colombia', 'PE': 'Peru', 'UY': 'Uruguay'
        };

        // Mapeamento de nomes em português para inglês (para compatibilidade com o mapa)
        const portugueseToEnglish = {
            'Brasil': 'Brazil',
            'Estados Unidos': 'United States',
            'Portugal': 'Portugal',
            'Espanha': 'Spain',
            'França': 'France',
            'Alemanha': 'Germany',
            'Itália': 'Italy',
            'Reino Unido': 'United Kingdom',
            'Canadá': 'Canada',
            'Austrália': 'Australia',
            'Japão': 'Japan',
            'China': 'China',
            'Índia': 'India',
            'Rússia': 'Russia',
            'México': 'Mexico',
            'Argentina': 'Argentina',
            'Chile': 'Chile',
            'Colômbia': 'Colombia',
            'Peru': 'Peru',
            'Uruguai': 'Uruguay',
            'Desconhecido': 'Unknown'
        };

        // Função para detectar o país do usuário automaticamente
        async function detectUserCountry() {
            try {
                console.log('🔍 Detectando país do usuário...');
                
                // Tentativa 1: API simples e confiável
                const response = await fetch('https://api.country.is/');
                if (!response.ok) throw new Error('API country.is falhou');
                
                const data = await response.json();
                const countryCode = data.country;
                
                if (countryCode && countryCode !== 'Undefined') {
                    const countryName = countryCodeToName[countryCode] || countryCode;
                    console.log(`✅ País detectado: ${countryName} (${countryCode})`);
                    return countryName;
                }
                
                throw new Error('País não detectado');
                
            } catch (error) {
                console.warn('❌ Erro na detecção automática:', error);
                
                // Tentativa 2: API alternativa
                try {
                    const fallbackResponse = await fetch('https://ipapi.co/country_name/');
                    if (fallbackResponse.ok) {
                        let countryName = await fallbackResponse.text();
                        if (countryName && countryName !== 'Undefined') {
                            // Converter para inglês se necessário
                            countryName = portugueseToEnglish[countryName] || countryName;
                            console.log(`✅ País detectado (fallback): ${countryName}`);
                            return countryName;
                        }
                    }
                } catch (fallbackError) {
                    console.warn('❌ Fallback também falhou:', fallbackError);
                }
                
                // Fallback final
                console.log('⚠️  Usando país padrão: Unknown');
                return 'Unknown';
            }
        }

        // Função para registrar acesso automaticamente quando a página carrega
        async function registerPageAccess() {
            // Verificar se já registrou acesso nesta sessão
            if (sessionStorage.getItem('accessRegistered')) {
                console.log('📝 Acesso já registrado nesta sessão');
                return;
            }
            
            try {
                const country = await detectUserCountry();
                await registerAccess(country);
                sessionStorage.setItem('accessRegistered', 'true');
                
                // Log para debug
                const currentData = JSON.parse(localStorage.getItem('accessData') || '{}');
                console.log('📊 Dados de acesso atualizados:', currentData);
                
            } catch (error) {
                console.error('❌ Erro ao registrar acesso:', error);
                // Registra como desconhecido mesmo em caso de erro
                await registerAccess('Unknown');
                sessionStorage.setItem('accessRegistered', 'true');
            }
        }

        // =============================================
        // FUNÇÕES EXISTENTES (ATUALIZADAS)
        // =============================================

        // Função para inicializar os dados de acesso
        function initializeAccessData() {
            const savedData = localStorage.getItem('accessData');
            if (savedData) {
                try {
                    accessData = JSON.parse(savedData);
                    console.log('📂 Dados de acesso carregados:', accessData);
                } catch (error) {
                    console.error('❌ Erro ao carregar dados, inicializando zerado:', error);
                    accessData = { totalAccesses: 0, countries: {} };
                    saveAccessData();
                }
            } else {
                accessData = { totalAccesses: 0, countries: {} };
                saveAccessData();
            }
        }

        // Função para salvar os dados de acesso
        function saveAccessData() {
            localStorage.setItem('accessData', JSON.stringify(accessData));
        }

        // Função para registrar um novo acesso (ATUALIZADA)
        async function registerAccess(country) {
            console.log(`📍 Registrando acesso do país: ${country}`);
            
            // Atualizar dados locais
            accessData.totalAccesses++;
            
            if (accessData.countries[country]) {
                accessData.countries[country]++;
            } else {
                accessData.countries[country] = 1;
            }
            
            saveAccessData();
            
            // Log para debug
            console.log(`✅ Acesso registrado: ${country} - Total: ${accessData.totalAccesses}`);
            
            // Atualizar a exibição se a página de acessos estiver aberta
            if (document.getElementById('access-content').style.display !== 'none') {
                displayAccessStats();
            }
        }

        // Função para exibir estatísticas de acesso
        function displayAccessStats() {
            document.getElementById('total-accesses').textContent = accessData.totalAccesses;
            document.getElementById('total-countries').textContent = Object.keys(accessData.countries).length;
            
            const countryListContent = document.getElementById('country-list-content');
            countryListContent.innerHTML = '';
            
            // Ordenar países por número de acessos (decrescente)
            const sortedCountries = Object.entries(accessData.countries)
                .sort((a, b) => b[1] - a[1]);
            
            sortedCountries.forEach(([country, count]) => {
                const countryItem = document.createElement('div');
                countryItem.className = 'country-item';
                countryItem.innerHTML = `
                    <span class="country-name">${country}</span>
                    <span class="country-count">${count}</span>
                `;
                countryListContent.appendChild(countryItem);
            });
            
            // Atualizar o mapa
            updateWorldMap();
            // Atualizar a legenda do mapa
            updateMapLegend();
        }

        // Função para criar/atualizar o mapa mundi
        function updateWorldMap() {
            const width = document.querySelector('.map-container').clientWidth;
            const height = document.querySelector('.map-container').clientHeight;
            
            // Limpar o mapa anterior
            d3.select("#world-map").html("");
            
            const svg = d3.select("#world-map")
                .append("svg")
                .attr("width", width)
                .attr("height", height);
            
            const projection = d3.geoNaturalEarth1()
                .scale(width / 6.5)
                .translate([width / 2, height / 2]);
            
            const path = d3.geoPath().projection(projection);
            
            // Cores para diferentes intensidades de acesso
            const colorScale = d3.scaleThreshold()
                .domain([1, 5, 15, 30, 50])
                .range(["#e6f2ff", "#b3d9ff", "#80bfff", "#4da6ff", "#1a8cff", "#0066cc"]);
            
            // Carregar dados do mundo
            d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json").then(function(world) {
                const countries = topojson.feature(world, world.objects.countries);
                
                svg.selectAll(".country")
                    .data(countries.features)
                    .enter().append("path")
                    .attr("class", "country")
                    .attr("d", path)
                    .attr("fill", function(d) {
                        const countryName = d.properties.name;
                        const accessCount = accessData.countries[countryName] || 0;
                        return colorScale(accessCount);
                    })
                    .style("stroke", "#fff")
                    .style("stroke-width", 0.5)
                    .on("mouseover", function(event, d) {
                        const countryName = d.properties.name;
                        const accessCount = accessData.countries[countryName] || 0;
                        
                        // Tooltip
                        const tooltip = d3.select("body")
                            .append("div")
                            .attr("class", "tooltip")
                            .style("position", "absolute")
                            .style("background", "white")
                            .style("padding", "5px 10px")
                            .style("border", "1px solid #ccc")
                            .style("border-radius", "4px")
                            .style("pointer-events", "none")
                            .style("opacity", 0);
                        
                        tooltip.transition()
                            .duration(200)
                            .style("opacity", .9);
                        tooltip.html(`${countryName}: ${accessCount} acesso(s)`)
                            .style("left", (event.pageX + 10) + "px")
                            .style("top", (event.pageY - 28) + "px");
                    })
                    .on("mouseout", function() {
                        d3.selectAll(".tooltip").remove();
                    });
            }).catch(function(error) {
                console.error("Erro ao carregar dados do mapa:", error);
                // Fallback: mostrar mensagem de erro
                d3.select("#world-map").html(`
                    <div style="text-align: center; padding: 50px; color: #666;">
                        <p>Não foi possível carregar o mapa mundial.</p>
                        <p>Verifique sua conexão com a internet.</p>
                    </div>
                `);
            });
        }

        // Função para atualizar a legenda do mapa
        function updateMapLegend() {
            const lang = currentLanguage;
            
            const legendTitle = document.querySelector('.legend-title');
            if (legendTitle) {
                legendTitle.textContent = translations[lang]['access-intensity'];
            }
            
            // Atualizar os textos da legenda
            document.querySelectorAll('.legend-label[data-translate]').forEach(label => {
                const key = label.getAttribute('data-translate');
                if (translations[lang][key]) {
                    label.textContent = translations[lang][key];
                }
            });
        }

        // =============================================
        // FUNÇÕES DE TESTE E DEBUG
        // =============================================

        // Função para testar o sistema de detecção de país
        window.testCountryDetection = async function() {
            console.log('🧪 TESTANDO DETECÇÃO DE PAÍS...');
            const country = await detectUserCountry();
            console.log(`🧪 Resultado do teste: ${country}`);
            return country;
        };

        // Função para ver estatísticas atuais
        window.showAccessStats = function() {
            console.log('📊 ESTATÍSTICAS ATUAIS:', accessData);
            return accessData;
        };

        // Função para simular acesso de diferentes países (para testes)
        window.simulateAccess = function(country) {
            registerAccess(country || 'Teste');
        };

        // =============================================
        // INICIALIZAÇÃO DO SISTEMA
        // =============================================

        // Inicializar quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Inicializando sistema de acessos...');
            
            // Inicializar dados
            initializeAccessData();
            
            // Registrar acesso automaticamente (com delay para não travar a UI)
            setTimeout(() => {
                registerPageAccess();
            }, 1000);
            
            console.log('✅ Sistema de acessos inicializado');
        });

        // =============================================
        // RESTANTE DO CÓDIGO EXISTENTE
        // =============================================

        // [O restante do código JavaScript permanece igual...]
        // Função para trocar idioma, navegação, matriz, cálculos, etc.

        // Função para trocar idioma
        function changeLanguage(lang) {
            currentLanguage = lang;
            
            // Atualizar as bandeiras
            document.getElementById('flag-br').classList.toggle('active', lang === 'pt-BR');
            document.getElementById('flag-gb').classList.toggle('active', lang === 'en');
            
            // Atualizar o título da página
            document.title = translations[lang].title;
            
            // Atualizar elementos de texto
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });
            
            // Atualizar atributos placeholder e value
            document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                if (translations[lang][key]) {
                    element.placeholder = translations[lang][key];
                }
            });
            
            document.querySelectorAll('[data-translate-value]').forEach(element => {
                const key = element.getAttribute('data-translate-value');
                if (translations[lang][key]) {
                    element.value = translations[lang][key];
                }
            });
            
            // Atualizar textos específicos que não usam data attributes
            document.querySelector('.logo').textContent = translations[lang].title;
            document.querySelector('.nav-link[data-page="home"]').textContent = translations[lang]['nav-home'];
            document.querySelector('.nav-link[data-page="about"]').textContent = translations[lang]['nav-about'];
            document.querySelector('.access-link').textContent = translations[lang]['nav-access'];
            document.getElementById('start-app').textContent = translations[lang]['start-app'];
            document.querySelector('.btn-secondary.nav-link[data-page="tutorial"]').textContent = translations[lang]['tutorial'];
            document.querySelector('.btn-secondary.nav-link[data-page="articles"]').textContent = translations[lang]['articles'];
            
            // Atualizar textos que podem estar na página atual
            updatePageTexts();
            
            // Atualizar a matriz se ela existir
            updateMatrixTexts();
            
            // Atualizar a legenda do mapa se estiver visível
            if (document.getElementById('access-content').style.display !== 'none') {
                updateMapLegend();
            }
        }

        // Função para atualizar textos específicos da página atual
        function updatePageTexts() {
            const lang = currentLanguage;
            
            // Página de configuração
            if (document.getElementById('config').classList.contains('active')) {
                document.querySelector('.config-title').textContent = translations[lang]['config-title'];
                document.querySelector('label[for="alternatives"]').textContent = translations[lang]['alternatives-label'];
                document.querySelector('label[for="states"]').textContent = translations[lang]['states-label'];
                document.getElementById('alternatives-error').textContent = translations[lang]['alternatives-error'];
                document.getElementById('states-error').textContent = translations[lang]['states-error'];
                document.getElementById('generate-matrix').textContent = translations[lang]['generate-matrix'];
            }
            
            // Página da matriz
            if (document.getElementById('matrix').classList.contains('active')) {
                document.querySelector('.matrix-title').textContent = translations[lang]['matrix-title'];
                document.getElementById('calculate-results').textContent = translations[lang]['calculate-results'];
                
                if (document.getElementById('results-container').style.display !== 'none') {
                    document.querySelector('.results-title').textContent = translations[lang]['results-title'];
                    document.getElementById('download-pdf').textContent = translations[lang]['download-pdf'];
                    document.getElementById('download-images').textContent = translations[lang]['download-images'];
                    document.querySelectorAll('.method-title')[0].textContent = translations[lang]['pascal-method'];
                    document.querySelectorAll('.method-title')[1].textContent = translations[lang]['markowitz-method'];
                }
            }
            
            // Página Sobre Nós
            if (document.getElementById('about').classList.contains('active')) {
                document.querySelector('.about-title').textContent = translations[lang]['about-title'];
            }
            
            // Página Tutorial
            if (document.getElementById('tutorial').classList.contains('active')) {
                document.querySelector('.tutorial-title').textContent = translations[lang]['tutorial-title'];
                document.querySelector('.youtube-link span').textContent = translations[lang]['youtube-link'];
            }
            
            // Página Artigos
            if (document.getElementById('articles').classList.contains('active')) {
                document.querySelector('.articles-title').textContent = translations[lang]['articles-title'];
            }
            
            // Página Acessos
            if (document.getElementById('access').classList.contains('active')) {
                document.querySelector('.access-title').textContent = translations[lang]['access-title'];
                document.querySelector('label[for="access-password"]').textContent = translations[lang]['access-password'];
                document.getElementById('access-error').textContent = translations[lang]['access-error'];
                document.getElementById('access-login').textContent = translations[lang]['access-login'];
                
                // Atualizar estatísticas se estiverem visíveis
                if (document.getElementById('access-content').style.display !== 'none') {
                    document.querySelector('.access-stats h3').textContent = translations[lang]['access-title'];
                    document.querySelectorAll('.stat-label')[0].textContent = translations[lang]['total-accesses'];
                    document.querySelectorAll('.stat-label')[1].textContent = translations[lang]['total-countries'];
                    document.querySelector('.country-list h4').textContent = translations[lang]['accesses-by-country'];
                    updateMapLegend();
                }
            }
            
            // Rodapé
            const footerTexts = document.querySelectorAll('.footer-text p');
            footerTexts[0].textContent = translations[lang]['footer-text1'];
            footerTexts[1].textContent = translations[lang]['footer-text2'];
            footerTexts[2].textContent = translations[lang]['footer-text3'];
        }

        // Função para atualizar os textos da matriz
        function updateMatrixTexts() {
            const lang = currentLanguage;
            
            // Atualizar cabeçalho da tabela
            const headerCell = document.querySelector('table th:first-child');
            if (headerCell) {
                headerCell.textContent = translations[lang]['alternatives-states'];
            }
            
            // Atualizar linha de probabilidades
            const probCell = document.querySelector('.prob-row td:first-child');
            if (probCell) {
                probCell.textContent = translations[lang]['probabilities'];
            }
            
            // Atualizar nomes dos estados
            document.querySelectorAll('.state-name').forEach((input, index) => {
                input.value = `${translations[lang]['state']} ${index + 1}`;
            });
            
            // Atualizar nomes das alternativas
            document.querySelectorAll('.alternative-name').forEach((input, index) => {
                input.value = `${translations[lang]['alternative']} ${index + 1}`;
            });
            
            // Atualizar display da soma
            const sumDisplay = document.getElementById('sum-display');
            if (sumDisplay && sumDisplay.textContent.includes('Soma')) {
                const currentSum = sumDisplay.textContent.split(': ')[1];
                sumDisplay.textContent = `${translations[lang]['sum-display']}${currentSum}`;
            }
        }

        // Event listeners para as bandeiras
        document.getElementById('flag-br').addEventListener('click', () => changeLanguage('pt-BR'));
        document.getElementById('flag-gb').addEventListener('click', () => changeLanguage('en'));

        // Navegação entre páginas
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const pageId = this.getAttribute('data-page');
                showPage(pageId);
            });
        });
        
        // Botão Iniciar Aplicação
        document.getElementById('start-app').addEventListener('click', function() {
            showPage('config');
        });
        
        // Função para mostrar página específica
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            // Atualizar textos quando mudar de página
            updatePageTexts();
            
            // Se for a página de acessos, resetar o formulário de login
            if (pageId === 'access') {
                document.getElementById('access-password').value = '';
                document.getElementById('access-error').style.display = 'none';
                document.getElementById('access-content').style.display = 'none';
                document.getElementById('access-login-container').style.display = 'block';
            }
        }
        
        // Login de acesso
        document.getElementById('access-login').addEventListener('click', function() {
            const password = document.getElementById('access-password').value;
            
            if (password === '123456') {
                document.getElementById('access-error').style.display = 'none';
                document.getElementById('access-login-container').style.display = 'none';
                document.getElementById('access-content').style.display = 'block';
                displayAccessStats();
            } else {
                document.getElementById('access-error').style.display = 'block';
            }
        });
        
        // Permitir login com Enter
        document.getElementById('access-password').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('access-login').click();
            }
        });
        
        // Gerar matriz de decisão
        document.getElementById('generate-matrix').addEventListener('click', function() {
            const alternatives = parseInt(document.getElementById('alternatives').value);
            const states = parseInt(document.getElementById('states').value);
            
            // Validação
            let valid = true;
            
            if (alternatives < 2) {
                document.getElementById('alternatives-error').style.display = 'block';
                valid = false;
            } else {
                document.getElementById('alternatives-error').style.display = 'none';
            }
            
            if (states < 2) {
                document.getElementById('states-error').style.display = 'block';
                valid = false;
            } else {
                document.getElementById('states-error').style.display = 'none';
            }
            
            if (!valid) return;
            
            // Gerar matriz
            generateMatrix(alternatives, states);
            showPage('matrix');
        });
        
        // Função para gerar a matriz de decisão
        function generateMatrix(alternatives, states) {
            const lang = currentLanguage;
            
            let matrixHTML = '<table>';
            
            // Cabeçalho
            matrixHTML += `<tr><th>${translations[lang]['alternatives-states']}</th>`;
            for (let i = 1; i <= states; i++) {
                matrixHTML += `<th><input type="text" class="state-name" value="${translations[lang]['state']} ${i}" style="width: 100%; border: none; background: transparent; color: white; text-align: center; font-weight: 600; font-size: 1.3rem;"></th>`;
            }
            matrixHTML += '</tr>';
            
            // Linha de probabilidades
            matrixHTML += `<tr class="prob-row"><td style="font-size: 1.3rem; color: var(--probability-blue);">${translations[lang]['probabilities']}</td>`;
            for (let i = 1; i <= states; i++) {
                matrixHTML += `<td><input type="number" class="probability" min="0" max="1" step="0.01" value="${(1/states).toFixed(2)}" style="width: 100%; border: none; background: transparent; text-align: center; font-weight: 600; font-size: 1.3rem; color: var(--probability-blue);"></td>`;
            }
            matrixHTML += '</tr>';
            
            // Alternativas
            for (let i = 1; i <= alternatives; i++) {
                matrixHTML += `<tr><td><input type="text" class="alternative-name" value="${translations[lang]['alternative']} ${i}" style="width: 100%; border: none; background: transparent; text-align: center; font-weight: 600; font-size: 1.3rem; color: var(--primary-blue);"></td>`;
                for (let j = 1; j <= states; j++) {
                    matrixHTML += `<td><input type="number" class="value-input" value="0" style="width: 100%; border: none; background: transparent; text-align: center; font-size: 1.3rem; color: var(--primary-blue);"></td>`;
                }
                matrixHTML += '</tr>';
            }
            
            matrixHTML += '</table>';
            
            document.getElementById('matrix-table').innerHTML = matrixHTML;
            document.getElementById('results-container').style.display = 'none';
            
            // Adicionar eventos para atualizar a soma das probabilidades
            document.querySelectorAll('.probability').forEach(input => {
                input.addEventListener('input', updateProbabilitySum);
                input.addEventListener('keydown', preventNegativeInput);
                input.addEventListener('blur', validateProbabilityInput);
            });
            
            updateProbabilitySum();
        }
        
        // Função para impedir entrada de números negativos
        function preventNegativeInput(e) {
            if (e.key === '-' || e.key === 'e' || e.key === 'E') {
                e.preventDefault();
            }
        }
        
        // Função para validar entrada de probabilidade
        function validateProbabilityInput(e) {
            const input = e.target;
            let value = parseFloat(input.value);
            
            // Se o valor for negativo, definir como 0
            if (value < 0) {
                input.value = '0';
                updateProbabilitySum();
            }
            
            // Se o valor for maior que 1, definir como 1
            if (value > 1) {
                input.value = '1';
                updateProbabilitySum();
            }
        }
        
        // Atualizar a soma das probabilidades
        function updateProbabilitySum() {
            const probabilities = document.querySelectorAll('.probability');
            let sum = 0;
            
            probabilities.forEach(input => {
                const value = parseFloat(input.value) || 0;
                sum += value;
            });
            
            const sumDisplay = document.getElementById('sum-display');
            sumDisplay.textContent = `${translations[currentLanguage]['sum-display']}${sum.toFixed(2)}`;
            
            if (Math.abs(sum - 1) > 0.01) {
                sumDisplay.className = 'sum-display sum-error';
            } else {
                sumDisplay.className = 'sum-display sum-ok';
            }
        }
        
        // Calcular resultados
        document.getElementById('calculate-results').addEventListener('click', function() {
            // Verificar se todos os campos estão preenchidos
            const emptyInputs = Array.from(document.querySelectorAll('.value-input, .probability, .alternative-name, .state-name'))
                .filter(input => input.value.trim() === '');
            
            if (emptyInputs.length > 0) {
                alert(currentLanguage === 'pt-BR' ? 'Por favor, preencha todos os campos da matriz.' : 'Please fill in all matrix fields.');
                return;
            }
            
            // Verificar se a soma das probabilidades é 1
            const probabilities = document.querySelectorAll('.probability');
            let sum = 0;
            
            probabilities.forEach(input => {
                const value = parseFloat(input.value) || 0;
                sum += value;
            });
            
            if (Math.abs(sum - 1) > 0.01) {
                alert(currentLanguage === 'pt-BR' ? 'A soma das probabilidades deve ser igual a 1.' : 'The sum of probabilities must be equal to 1.');
                return;
            }
            
            // Calcular resultados
            calculateResults();
            document.getElementById('results-container').style.display = 'block';
            
            // Atualizar textos dos resultados
            updatePageTexts();
        });
        
        // Função para calcular os resultados
        function calculateResults() {
            const alternatives = document.querySelectorAll('.alternative-name');
            const stateNames = Array.from(document.querySelectorAll('.state-name')).map(input => input.value);
            const probabilities = Array.from(document.querySelectorAll('.probability')).map(input => parseFloat(input.value));
            const values = [];
            
            // Coletar valores
            document.querySelectorAll('tr').forEach((row, rowIndex) => {
                if (rowIndex < 2) return; // Pular cabeçalho e linha de probabilidades
                
                const rowValues = [];
                row.querySelectorAll('.value-input').forEach(input => {
                    rowValues.push(parseFloat(input.value));
                });
                
                if (rowValues.length > 0) {
                    values.push({
                        name: row.querySelector('.alternative-name').value,
                        values: rowValues
                    });
                }
            });
            
            // Calcular método de Pascal (esperança)
            const pascalResults = values.map(alternative => {
                let expectedValue = 0;
                
                for (let i = 0; i < alternative.values.length; i++) {
                    expectedValue += alternative.values[i] * probabilities[i];
                }
                
                return {
                    name: alternative.name,
                    expectedValue: expectedValue
                };
            });
            
            // Ordenar por valor esperado (decrescente)
            pascalResults.sort((a, b) => b.expectedValue - a.expectedValue);
            
            // Exibir resultados do método de Pascal
            let pascalHTML = '<div class="ranking">';
            pascalResults.forEach((result, index) => {
                const isWinner = index === 0;
                pascalHTML += `
                    <div class="ranking-item ${isWinner ? 'ranking-winner' : ''}">
                        <span class="ranking-position">${index + 1}º</span>
                        <span>${result.name}</span>
                        <span>E(X) = ${result.expectedValue.toFixed(2)}</span>
                    </div>
                `;
            });
            pascalHTML += '</div>';
            
            document.getElementById('pascal-results').innerHTML = pascalHTML;
            
            // Calcular método de Markowitz
            const markowitzResults = values.map(alternative => {
                // Primeiro calcular o valor esperado (já calculado acima)
                let expectedValue = 0;
                for (let i = 0; i < alternative.values.length; i++) {
                    expectedValue += alternative.values[i] * probabilities[i];
                }
                
                // Calcular variância: Σ [x_ij - E(X_i)]² × p_j
                let variance = 0;
                for (let i = 0; i < alternative.values.length; i++) {
                    const deviation = alternative.values[i] - expectedValue;
                    variance += Math.pow(deviation, 2) * probabilities[i];
                }
                
                // Calcular desvio padrão
                const standardDeviation = Math.sqrt(variance);
                
                // Calcular índice de Markowitz
                const markowitzIndex = standardDeviation > 0 ? expectedValue / standardDeviation : 0;
                
                return {
                    name: alternative.name,
                    expectedValue: expectedValue,
                    variance: variance,
                    standardDeviation: standardDeviation,
                    markowitzIndex: markowitzIndex
                };
            });
            
            // Ordenar por índice de Markowitz (decrescente)
            markowitzResults.sort((a, b) => b.markowitzIndex - a.markowitzIndex);
            
            // Exibir resultados do método de Markowitz
            let markowitzHTML = '<div class="ranking">';
            markowitzResults.forEach((result, index) => {
                const isWinner = index === 0;
                markowitzHTML += `
                    <div class="ranking-item ${isWinner ? 'ranking-winner' : ''}">
                        <span class="ranking-position">${index + 1}º</span>
                        <span>${result.name}</span>
                        <span>A = ${result.markowitzIndex.toFixed(2)}</span>
                    </div>
                `;
            });
            
            markowitzHTML += '</div><table style="margin-top: 1rem; font-size: 1.2rem;">';
            markowitzHTML += `<tr><th>${translations[currentLanguage]['alternative']}</th><th>E(X)</th><th>Var(X)</th><th>σ</th><th>A = E(X)/σ</th></tr>`;
            
            markowitzResults.forEach(result => {
                markowitzHTML += `
                    <tr>
                        <td>${result.name}</td>
                        <td>${result.expectedValue.toFixed(2)}</td>
                        <td>${result.variance.toFixed(2)}</td>
                        <td>${result.standardDeviation.toFixed(2)}</td>
                        <td>${result.markowitzIndex.toFixed(2)}</td>
                    </tr>
                `;
            });
            
            markowitzHTML += '</table>';
            
            document.getElementById('markowitz-results').innerHTML = markowitzHTML;
        }
        
        // Baixar PDF
        document.getElementById('download-pdf').addEventListener('click', function() {
            generatePDF();
        });
        
        // Baixar imagens
        document.getElementById('download-images').addEventListener('click', function() {
            downloadImages();
        });
        
        // Função para gerar PDF
        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            const margin = 15;
            
            // Adicionar título
            doc.setFontSize(18);
            doc.setFont('helvetica', 'bold');
            doc.text(currentLanguage === 'pt-BR' ? 'Resultados dos Métodos de Pascal e Markowitz' : 'Results of Pascal and Markowitz Methods', margin, 20);
            
            // Adicionar data
            const today = new Date();
            const dateStr = today.toLocaleDateString(currentLanguage === 'pt-BR' ? 'pt-BR' : 'en-US');
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            doc.text(`${currentLanguage === 'pt-BR' ? 'Data: ' : 'Date: '}${dateStr}`, margin, 30);
            
            // Adicionar matriz de decisão
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text(currentLanguage === 'pt-BR' ? 'Matriz de Decisão' : 'Decision Matrix', margin, 45);
            
            // Criar matriz otimizada para PDF
            const alternatives = document.querySelectorAll('.alternative-name');
            const states = document.querySelectorAll('.state-name');
            const probabilities = document.querySelectorAll('.probability');
            const values = document.querySelectorAll('.value-input');
            
            // Calcular largura das colunas
            const colWidth = (pageWidth - 2 * margin) / (states.length + 1);
            const rowHeight = 8;
            
            let yPos = 55;
            
            // Desenhar cabeçalho
            doc.setFillColor(32, 91, 170);
            doc.rect(margin, yPos, pageWidth - 2 * margin, rowHeight, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(9);
            doc.text(currentLanguage === 'pt-BR' ? 'Alternativas' : 'Alternatives', margin + 2, yPos + 5);
            
            for (let i = 0; i < states.length; i++) {
                const stateName = states[i].value;
                doc.text(stateName, margin + colWidth * (i + 1) + 2, yPos + 5);
            }
            
            yPos += rowHeight;
            
            // Desenhar linha de probabilidades
            doc.setFillColor(238, 240, 241);
            doc.rect(margin, yPos, pageWidth - 2 * margin, rowHeight, 'F');
            doc.setTextColor(32, 91, 170);
            doc.text(currentLanguage === 'pt-BR' ? 'Probabilidades' : 'Probabilities', margin + 2, yPos + 5);
            
            for (let i = 0; i < probabilities.length; i++) {
                const prob = parseFloat(probabilities[i].value).toFixed(2);
                doc.text(prob, margin + colWidth * (i + 1) + 2, yPos + 5);
            }
            
            yPos += rowHeight;
            
            // Desenhar alternativas
            doc.setFillColor(255, 255, 255);
            doc.setTextColor(0, 0, 0);
            
            for (let i = 0; i < alternatives.length; i++) {
                if (i % 2 === 0) {
                    doc.setFillColor(240, 240, 240);
                } else {
                    doc.setFillColor(255, 255, 255);
                }
                
                doc.rect(margin, yPos, pageWidth - 2 * margin, rowHeight, 'F');
                
                // Nome da alternativa
                doc.text(alternatives[i].value, margin + 2, yPos + 5);
                
                // Valores
                for (let j = 0; j < states.length; j++) {
                    const valueIndex = i * states.length + j;
                    const value = values[valueIndex].value;
                    doc.text(value, margin + colWidth * (j + 1) + 2, yPos + 5);
                }
                
                yPos += rowHeight;
                
                if (yPos > pageHeight - 20) {
                    doc.addPage();
                    yPos = margin;
                }
            }
            
            // Adicionar resultados do método de Pascal
            doc.addPage();
            yPos = margin;
            
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text(currentLanguage === 'pt-BR' ? 'Método de Pascal' : 'Pascal Method', margin, yPos);
            yPos += 10;
            
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            
            const pascalResults = document.querySelectorAll('#pascal-results .ranking-item');
            pascalResults.forEach((item, index) => {
                const position = item.querySelector('.ranking-position').textContent;
                const name = item.querySelector('span:nth-child(2)').textContent;
                const value = item.querySelector('span:nth-child(3)').textContent;
                
                doc.text(`${position} - ${name} - ${value}`, margin, yPos);
                yPos += 6;
                
                if (yPos > pageHeight - 10) {
                    doc.addPage();
                    yPos = margin;
                }
            });
            
            // Adicionar resultados do método de Markowitz
            doc.addPage();
            yPos = margin;
            
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text(currentLanguage === 'pt-BR' ? 'Método de Markowitz' : 'Markowitz Method', margin, yPos);
            yPos += 10;
            
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            
            const markowitzResults = document.querySelectorAll('#markowitz-results .ranking-item');
            markowitzResults.forEach((item, index) => {
                const position = item.querySelector('.ranking-position').textContent;
                const name = item.querySelector('span:nth-child(2)').textContent;
                const value = item.querySelector('span:nth-child(3)').textContent;
                
                doc.text(`${position} - ${name} - ${value}`, margin, yPos);
                yPos += 6;
                
                if (yPos > pageHeight - 10) {
                    doc.addPage();
                    yPos = margin;
                }
            });
            
            // Adicionar tabela detalhada de Markowitz
            yPos += 5;
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.text(currentLanguage === 'pt-BR' ? 'Detalhamento do Método de Markowitz' : 'Markowitz Method Details', margin, yPos);
            yPos += 8;
            
            // Cabeçalho da tabela
            doc.setFillColor(32, 91, 170);
            doc.rect(margin, yPos, pageWidth - 2 * margin, rowHeight, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(8);
            
            const markowitzCols = currentLanguage === 'pt-BR' 
                ? ['Alternativa', 'E(X)', 'Var(X)', 'Desvio Padrão', 'Pontuação'] 
                : ['Alternative', 'E(X)', 'Var(X)', 'Standard Dev.', 'Score'];
            const markowitzColWidth = (pageWidth - 2 * margin) / markowitzCols.length;
            
            markowitzCols.forEach((col, index) => {
                doc.text(col, margin + markowitzColWidth * index + 2, yPos + 5);
            });
            
            yPos += rowHeight;
            
            // Dados da tabela
            const markowitzTable = document.querySelector('#markowitz-results table');
            const markowitzRows = markowitzTable.querySelectorAll('tr');
            
            doc.setTextColor(0, 0, 0);
            
            for (let i = 1; i < markowitzRows.length; i++) {
                const cells = markowitzRows[i].querySelectorAll('td');
                
                if (i % 2 === 0) {
                    doc.setFillColor(240, 240, 240);
                } else {
                    doc.setFillColor(255, 255, 255);
                }
                
                doc.rect(margin, yPos, pageWidth - 2 * margin, rowHeight, 'F');
                
                cells.forEach((cell, cellIndex) => {
                    doc.text(cell.textContent, margin + markowitzColWidth * cellIndex + 2, yPos + 5);
                });
                
                yPos += rowHeight;
                
                if (yPos > pageHeight - 10) {
                    doc.addPage();
                    yPos = margin;
                    
                    doc.setFillColor(32, 91, 170);
                    doc.rect(margin, yPos, pageWidth - 2 * margin, rowHeight, 'F');
                    doc.setTextColor(255, 255, 255);
                    
                    markowitzCols.forEach((col, index) => {
                        doc.text(col, margin + markowitzColWidth * index + 2, yPos + 5);
                    });
                    
                    yPos += rowHeight;
                }
            }
            
            // Salvar o PDF
            doc.save(currentLanguage === 'pt-BR' ? 'resultados-pascal-markowitz.pdf' : 'pascal-markowitz-results.pdf');
        }
        
        // Função para baixar imagens
        function downloadImages() {
            // Capturar matriz de decisão
            const matrixElement = document.getElementById('matrix-table');
            
            html2canvas(matrixElement, {
                scale: 2,
                useCORS: true,
                logging: false
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = currentLanguage === 'pt-BR' ? 'matriz-decisao.png' : 'decision-matrix.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                // Capturar resultados de Pascal
                const pascalElement = document.getElementById('pascal-results');
                
                html2canvas(pascalElement, {
                    scale: 2,
                    useCORS: true,
                    logging: false
                }).then(canvas => {
                    const link = document.createElement('a');
                    link.download = currentLanguage === 'pt-BR' ? 'resultados-pascal.png' : 'pascal-results.png';
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                    
                    // Capturar resultados de Markowitz
                    const markowitzElement = document.getElementById('markowitz-results');
                    
                    html2canvas(markowitzElement, {
                        scale: 2,
                        useCORS: true,
                        logging: false
                    }).then(canvas => {
                        const link = document.createElement('a');
                        link.download = currentLanguage === 'pt-BR' ? 'resultados-markowitz.png' : 'markowitz-results.png';
                        link.href = canvas.toDataURL('image/png');
                        link.click();
                    });
                });
            });
        }
        
        // Carrossel do Tutorial
        let currentSlide = 0;
        const slides = document.querySelectorAll('.carousel-slide');
        const indicators = document.querySelectorAll('.carousel-indicator');
        const prevButton = document.querySelector('.carousel-prev');
        const nextButton = document.querySelector('.carousel-next');
        
        // Função para mostrar slide específico
        function showSlide(index) {
            if (index < 0) {
                currentSlide = slides.length - 1;
            } else if (index >= slides.length) {
                currentSlide = 0;
            } else {
                currentSlide = index;
            }
            
            const slidesContainer = document.querySelector('.carousel-slides');
            slidesContainer.style.transform = `translateX(-${currentSlide * 100}%)`;
            
            indicators.forEach((indicator, i) => {
                if (i === currentSlide) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            });
        }
        
        // Eventos dos botões do carrossel
        prevButton.addEventListener('click', () => {
            showSlide(currentSlide - 1);
        });
        
        nextButton.addEventListener('click', () => {
            showSlide(currentSlide + 1);
        });
        
        // Eventos dos indicadores
        indicators.forEach((indicator, index) => {
            indicator.addEventListener('click', () => {
                showSlide(index);
            });
        });
        
        // Navegação por teclado
        document.addEventListener('keydown', (e) => {
            if (document.getElementById('tutorial').classList.contains('active')) {
                if (e.key === 'ArrowLeft') {
                    showSlide(currentSlide - 1);
                } else if (e.key === 'ArrowRight') {
                    showSlide(currentSlide + 1);
                }
            }
        });
        
        // Inicializar carrossel
        showSlide(0);
    </script>
</body>
</html>